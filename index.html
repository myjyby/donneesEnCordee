<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8'>
	<meta name='viewport' content='width=device-width, initial-scale=1.0'>
	<title>Données en cordée</title>

	<!-- <script type='text/javascript' src='https://d3js.org/d3.v5.min.js'></script>
	<script type='text/javascript' src='https://d3js.org/d3-selection-multi.v1.min.js'></script>
	<script type='text/javascript' src='https://unpkg.com/topojson@3'></script>
	<script type='text/javascript' src='https://npmcdn.com/@turf/turf/turf.min.js'></script> -->
	<script type='text/javascript' src='./libs/d3.min.js'></script>
	<script type='text/javascript' src='./libs/d3-selection-multi.min.js'></script>
	<script type='text/javascript' src='./libs/topojson.min.js'></script>
	<script type='text/javascript' src='./libs/turf.min.js'></script>

	<script type='text/javascript' src='./js/base.fn.js'></script>
	<script type='text/javascript' src='./js/modules.ui.js'></script>
	<script type='text/javascript' src='./js/modules.menu.js'></script>
	<script type='text/javascript' src='./js/modules.mountains.js'></script>
	<script type='text/javascript' src='./js/modules.map.js'></script>
	<script type='text/javascript' src='./js/modules.reasoning.js'></script>

	<link rel='stylesheet' type='text/css' href='./css/main.css'>
	<link rel='stylesheet' type='text/css' href='./css/shapes.css'>
</head>

<body>

	<div class='slide intro bg-dark v-align'>
		<div class='inner center'>
		</div>
		<!-- <div class='nav-indicateurs'>
			<a href='indicateurs.html'>Voir le détail des indicateurs</a>
		</div> -->
	</div>

	<div class='slide vis bg-uniform'>
	<!-- <div class='slide vis bg-gradient'> -->
		<div class='header'>
			<div class='btn abs-scale active'>Absolue</div>
			<div class='btn norm-scale'>Par habitant</div>
		</div>

		<div class='content'>
			<div class='menu--vis'>
			</div>
			<div class='paysage--vis'>
			</div>
			<div class='cordee--vis'>
			</div>
		</div>
	</div>

<script type='text/javascript'>
	let maxHeight
	const debug = false

	var montagnes

	const promise = []
	promise.push(d3.csv('./data/data.csv'))
	promise.push(d3.csv('./data/indicators.csv'))
	promise.push(d3.json('./data/carte-redessinee.json'))
	Promise.all(promise).then(res => {
			// if (err) throw err
			const data = res[0]
			const indicators = res[1]
			const dessin = res[2]

			const communes = d3.set(data.map(d => d.Commune_court)).values()

			data.forEach(d => {
				for (let key in d) 
					if (Number.isInteger(+d[key]) && d[key] !== 0) d[key] = +d[key]
			})

			maxHeight = height() / data.length

			// const geojson = topojson.feature(topo, topo.objects.lc_EPSG2154)

			// // INITIALIZE THE USER INTERFACE
			Menu.init(indicators)
			UI.init() 

			Mountains.init(data)
			Map.init(dessin)
			Reasoning.init(data)
			// montagnes = new Mountains(data)
		})

</script>

</body>

</html>