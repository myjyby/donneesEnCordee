<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8'>
	<meta name='viewport' content='width=device-width, initial-scale=1.0'>
	<title>Données en cordée</title>

	<script type='text/javascript' src='https://d3js.org/d3.v4.min.js'></script>
	<script type='text/javascript' src='https://d3js.org/d3-selection-multi.v1.min.js'></script>
	<script type='text/javascript' src='https://unpkg.com/topojson@3'></script>

	<script type='text/javascript' src='./js/base.fn.js'></script>
	<script type='text/javascript' src='./js/modules.ui.js'></script>
	<script type='text/javascript' src='./js/modules.menu.js'></script>
	<script type='text/javascript' src='./js/modules.mountains.js'></script>
	<script type='text/javascript' src='./js/modules.map.js'></script>
	<script type='text/javascript' src='./js/modules.reasoning.js'></script>

	<link rel='stylesheet' type='text/css' href='css/main.css'>
</head>

<body>

	<div class='slide intro bg-dark v-align'>
		<div class='inner center'>
			<h1 class='main-title'>Données en Cordée</h1>
		</div>
	</div>

	<div class='slide vis bg-gradient'>
		<div class='header'>
			<div class='btn abs-scale active'>Absolue</div>
			<div class='btn norm-scale'>Normalisée</div>
		</div>
	</div>

<script type='text/javascript'>
	let maxHeight
	const debug = false

	var montagnes

	d3.queue()
		.defer(d3.csv, './data/dataPo.csv')
		.defer(d3.csv, './data/indicatorsPo.csv')
		.defer(d3.json, './data/lc.topojson')
		.await((err, data, indicators, topo) => {
			if (err) throw err

			const communes = d3.set(data.map(d => d.Commune_court)).values()

			data.forEach(d => {
				for (let key in d) 
					if (Number.isInteger(+d[key]) && d[key] !== 0) d[key] = +d[key]
			})

			maxHeight = height() / data.length

			const geojson = topojson.feature(topo, topo.objects.lc_EPSG2154)

			// // INITIALIZE THE USER INTERFACE
			UI.init()
			Menu.init(indicators)

			Mountains.init(data)
			Map.init(geojson)
			Reasoning.init(data)

			// montagnes = new Mountains(data)
		})

</script>

</body>

</html>